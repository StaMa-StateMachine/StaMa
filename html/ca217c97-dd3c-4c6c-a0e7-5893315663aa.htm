<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Using Visio Shapes</title><meta name="Language" content="en-us" /><meta name="Microsoft.Help.Id" content="ca217c97-dd3c-4c6c-a0e7-5893315663aa" /><meta name="Description" content="Explains how to use the accompanying Microsoft Visio http://office.microsoft.com/visio/ template and shapes to create a state machine diagram and generate the state machine structure definition code from it." /><meta name="Microsoft.Help.ContentType" content="Concepts" /><meta name="BrandingAware" content="true" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">StaMa - State Machine Controller Library 2.3.0.3 - Developers Guide and Reference<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d3287120-e3fa-45ed-8986-ba6d78244c1c.htm" title="StaMa - State Machine Controller Library 2.3.0.3 - Developers Guide and Reference" tocid="roottoc">StaMa - State Machine Controller Library 2.3.0.3 - Developers Guide and Reference</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d3287120-e3fa-45ed-8986-ba6d78244c1c.htm" title="Developer's Guide" tocid="dee243eb-29a4-4788-9230-540414b1d1f9">Developer's Guide</a></div><div class="toclevel1 current" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="ca217c97-dd3c-4c6c-a0e7-5893315663aa.htm" title="Using Visio Shapes" tocid="ca217c97-dd3c-4c6c-a0e7-5893315663aa">Using Visio Shapes</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="a4db1100-01f4-4594-b23c-948cbd01b5e7.htm" title="Shape Types" tocid="a4db1100-01f4-4594-b23c-948cbd01b5e7">Shape Types</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="d84688d1-ab43-4437-b9fe-aeecc03b5d0e.htm" title="Step by Step Descriptions for Tasks" tocid="d84688d1-ab43-4437-b9fe-aeecc03b5d0e">Step by Step Descriptions for Tasks</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img alt="StaMa" src="../icons/StaMa32x32.png" /></td><td class="titleColumn">Using Visio Shapes</td></tr></table><span class="introStyle"></span><div class="summary"><p>
        Explains how to use the accompanying <a href="http://office.microsoft.com/visio/" target="_blank">Microsoft Visio</a> template and shapes to create a state machine diagram and generate the state machine structure definition code from it.
      </p></div><div class="introduction"><p>
        Plain state diagrams are a common means to sketch the behavior of a component during its inception phase.
        Apparently the state machine design approach is inherently a visual design technique.
      </p><p>
        A state diagram is essential for communicating the state machine behavior to other stakeholders in the software development process.
        It should never go out of sync with the actual implementation, as it is a superior communication media compared to the source code.
      </p><p>
        Generating the code from the diagram ensures the visual representation of the component behavior is always up to date and in sync with the source code implementation.
      </p><p><a href="https://StaMa-StateMachine.github.io/" target="_blank">StaMa</a> provides a document Template and a set of shapes for <a href="http://office.microsoft.com/visio/" target="_blank">Microsoft Visio</a> that support drawing state diagrams and generate code from them.
      </p><p>
        The <a href="http://office.microsoft.com/visio/" target="_blank">Microsoft Visio</a> template and shapes can generate the <a href="16986707-6029-42de-a453-8b359b07248a.htm">StateMachineTemplate</a> structure definition with the
        <a href="M_StaMa_StateMachineTemplate_Region.htm">Region</a>,
        <a href="M_StaMa_StateMachineTemplate_EndRegion.htm">EndRegion</a>,
        <a href="Overload_StaMa_StateMachineTemplate_State.htm">State</a>,
        <a href="M_StaMa_StateMachineTemplate_EndState.htm">EndState</a>
        and <a href="Overload_StaMa_StateMachineTemplate_Transition.htm">Transition</a> statements.
        Further the code generator can be adapted to emit lists of identifiers for states, transitions, events, actions and conditions.
      </p><p>
        Action and condition code is not defined within the diagram, instead it is suggested to encapsulate the action and condition code within methods and functions with speaking names.
        These methods and functions are referenced in the diagram as entry actions, exit actions, transition actions and guard conditions.
      </p><div class="alert"><table><tr><th><img src="../icons/AlertCaution.png" alt="Caution note" /> Caution</th></tr><tr><td><p>
          The visual representation of regions, states and transitions created with <a href="ca217c97-dd3c-4c6c-a0e7-5893315663aa.htm">StaMa Visio Shapes</a> is partially different from the description of <a href="http://www.omg.org/spec/UML/2.5/Beta2/PDF/" target="_blank">OMG UML Specification</a>.
        </p><p>
          Generally there shouldn't be a problem to map diagrams created with <a href="ca217c97-dd3c-4c6c-a0e7-5893315663aa.htm">StaMa Visio Shapes</a> to the corresponding visual representations and semantic constructs of <a href="http://www.omg.org/spec/UML/2.5/Beta2/PDF/" target="_blank">OMG UML Specification</a>.
          However the collaboration with developers that expect a <a href="http://www.omg.org/spec/UML/2.5/Beta2/PDF/" target="_blank">OMG UML Specification</a> conformant visualization may be impaired.
        </p></td></tr></table></div><div class="alert"><table><tr><th><img src="../icons/AlertCaution.png" alt="Caution note" /> Caution</th></tr><tr><td><p>
          The code generator requires the <a href="http://office.microsoft.com/visio/" target="_blank">Microsoft Visio</a> 32-bit version.
        </p><p>
          If <a href="ca217c97-dd3c-4c6c-a0e7-5893315663aa.htm">StaMa Visio Shapes</a> based diagrams are openend with the 64-bit version of <a href="http://office.microsoft.com/visio/" target="_blank">Microsoft Visio</a>, one or more of the message boxes as <a href="#Visio32bitLimitation">below</a> will be shown.
        </p></td></tr></table></div></div><div class="collapsibleAreaRegion" id="ShapeTypes"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Shape Types</span></div><div id="ID0RBSection" class="collapsibleSection"><p>
          The below set of <a href="http://office.microsoft.com/visio/" target="_blank">Microsoft Visio</a> shapes allows to assemble state diagrams of any complexity as explained in <a href="298801d3-40ad-4fae-816e-5a7e1afb0ff0.htm">Programming State Machines</a></p><p>
          The shapes must be arranged and connected in a specific way to form a valid state machine diagram.
          If they are not properly connected, the code generator emits incomplete code that usually doesn't compile.
        </p><p>
          Seen from a <a href="http://office.microsoft.com/visio/" target="_blank">Microsoft Visio</a> graphical object point of view
          the composition hierarchy of states and regions is provided through the <a href="http://office.microsoft.com/visio/" target="_blank">Microsoft Visio</a> grouping concept with an arbitrary depth nesting.
          Transitions are top level graphical objects that connect to the states.
          Each transition is composed of a transition knot that must be connected to the source state and a transition segment that must be connected to the targt state.
          In case of join and fork transitions the single transition knot must be extended with additional transition segments that connect to the multiple source and target states.
        </p><ul><li><p><a href="31807e1f-17b3-484d-b250-1cc6eb0e85bf.htm">State Shape</a></p></li><li><p><a href="29cbc4cc-2c35-40ca-b3eb-cc08ff2cd7e1.htm">Region Shape</a></p></li><li><p><a href="9611a508-1db1-452a-8d6e-3ae59b29b5e1.htm">Transition Knot Shape</a></p></li><li><p><a href="20d05290-66a0-43f9-8210-b3f384666daf.htm">Transition Segment Shape</a></p></li><li><p><a href="0898043b-ab92-416b-9347-1ff54fcbd5a8.htm">Code Generator Shape</a></p></li></ul></div><div class="collapsibleAreaRegion" id="HowToSections"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID1RB')" onkeypress="SectionExpandCollapse_CheckKey('ID1RB', event)" tabindex="0"><img id="ID1RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />HowTo Sections</span></div><div id="ID1RBSection" class="collapsibleSection"><p>
          The following sections describe step by step how to use the shapes to create a particular state machine fragment.
        </p><ul><li><p><a href="b118384c-7479-4dd8-82e8-18e9a13b35f6.htm">Create a Basic State Diagram and Generate Code from It</a></p></li><li><p><a href="1b54bfbf-f269-4c50-8695-8ff430dee73b.htm">Create a Plain Transition and Control Its Generated Code</a></p></li><li><p><a href="9d4e9992-3c8d-49a8-9818-18f5d488af7e.htm">Create a Composite State</a></p></li><li><p><a href="9110ef28-d0d9-40ac-a09d-2263809f5f45.htm">Add a Second, Orthogonal Region to a Composite State</a></p></li><li><p><a href="6ac8c54b-c9fa-4085-80f9-b816430ae62d.htm">Create a Fork Transition</a></p></li><li><p><a href="5a2e1160-ce69-4b22-97fe-bf986343fd1e.htm">Create a Join Transition</a></p></li><li><p><a href="2879867d-8e74-4dbd-861a-292bc54d505b.htm">Generate Code for Enumerations of States, Signal Events and Actions</a></p></li></ul></div><div class="collapsibleAreaRegion" id="Visio32bitLimitation"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Limitation to Visio 32-bit version</span></div><div id="ID2RBSection" class="collapsibleSection"><p>
          The code generator requires the <a href="http://office.microsoft.com/visio/" target="_blank">Microsoft Visio</a> 32-bit version.
        </p><p>
          If <a href="ca217c97-dd3c-4c6c-a0e7-5893315663aa.htm">StaMa Visio Shapes</a> based diagrams are openend with the 64-bit version of <a href="http://office.microsoft.com/visio/" target="_blank">Microsoft Visio</a>, one or more of the following message boxes will be shown:
        </p><div class="mediaCenter"><img alt="Visio64WarningMsComCtlOcx" src="../media/Visio64WarningMsComCtlOcx.png" /></div><div class="mediaCenter"><img alt="Visio64WarningStaMaCodegen" src="../media/Visio64WarningStaMaCodegen.png" /></div><div class="mediaCenter"><img alt="Visio64WarningVbaCompileError" src="../media/Visio64WarningVbaCompileError.png" /></div><p>
          The <a href="0898043b-ab92-416b-9347-1ff54fcbd5a8.htm">code generator shapes</a> use <a href="0898043b-ab92-416b-9347-1ff54fcbd5a8.htm#CodeGeneratorExpressionsAndVariables">expressions</a> written in <a href="http://msdn.microsoft.com/en-us/library/d1wf56tt.aspx" target="_blank">Visual Basic Script</a> to customize the generated code. <a href="http://msdn.microsoft.com/en-us/library/d1wf56tt.aspx" target="_blank">Visual Basic Script</a> is provided through the Microsoft Script Control (msscript.ocx) which is only available for 32-bit applications.
        </p><p>
          See also
          <a href="https://technet.microsoft.com/en-us/library/ee681792.aspx" target="_blank">64-bit versions of Office</a> and
          <a href="https://support.office.com/en-CA/article/Choose-the-32-bit-or-64-bit-version-of-Office-2dee7807-8f95-4d0c-b5fe-6c6f49b8d261" target="_blank">Choose the 32-bit or 64-bit version of Office</a>
          regarding provider recommendations about Office versions.
        </p></div></div></div><div id="pageFooter" class="pageFooter">Documentation generated on 28-Mrz-2016  <p><a href="https://github.com/StaMa-StateMachine/StaMa/issues" target="_blank">Report issues at https://github.com/StaMa-StateMachine/StaMa/</a></p></div></body></html>